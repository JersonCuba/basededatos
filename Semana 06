--SubConsulta Escalar
SELECT titulo, paginas
FROM Libros
WHERE paginas > (SELECT AVG(paginas) FROM Libros);

--EXISTS
FROM Usuarios u
WHERE EXISTS (
    SELECT 1 
    FROM Prestamos p
    WHERE p.id_usuario = u.id_usuario
);

--NOT EXISTS
SELECT nombre
FROM Usuarios u
WHERE NOT EXISTS (
    SELECT 1 
    FROM Prestamos p
    WHERE p.id_usuario = u.id_usuario
);


--IN
SELECT titulo
FROM Libros
WHERE id_libro IN (
    SELECT id_libro
    FROM Prestamos
    WHERE id_usuario IN (
        SELECT id_usuario
        FROM Usuarios
        WHERE carrera = 'Psicología'
    )
);


--INNER JOIN
SELECT u.nombre, l.titulo
FROM Prestamos p
INNER JOIN Usuarios u ON p.id_usuario = u.id_usuario
INNER JOIN Libros l ON p.id_libro = l.id_libro;



--LEFT JOIN
SELECT u.nombre, l.titulo
FROM Usuarios u
LEFT JOIN Prestamos p ON u.id_usuario = p.id_usuario
LEFT JOIN Libros l ON p.id_libro = l.id_libro;


--RIGHT JOIN
SELECT l.titulo, u.nombre
FROM Libros l
RIGHT JOIN Prestamos p ON l.id_libro = p.id_libro
RIGHT JOIN Usuarios u ON p.id_usuario = u.id_usuario;


--FULL JOIN
SELECT u.nombre, l.titulo
FROM Usuarios u
LEFT JOIN Prestamos p ON u.id_usuario = p.id_usuario
LEFT JOIN Libros l ON p.id_libro = l.id_libro
UNION
SELECT u.nombre, l.titulo
FROM Libros l
LEFT JOIN Prestamos p ON l.id_libro = p.id_libro
LEFT JOIN Usuarios u ON p.id_usuario = u.id_usuario;


--CROSS JOIN
SELECT u.nombre, l.titulo
FROM Usuarios u
CROSS JOIN Libros l;


-- UNION elimina duplicados
SELECT nombre FROM Usuarios WHERE carrera = 'Ingeniería'
UNION
SELECT nombre FROM Usuarios WHERE carrera = 'Psicología';

-- UNION ALL mantiene duplicados
SELECT nombre FROM Usuarios WHERE carrera = 'Ingeniería'
UNION ALL
SELECT nombre FROM Usuarios WHERE carrera = 'Psicología'

